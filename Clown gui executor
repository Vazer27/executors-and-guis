local Players = game:GetService("Players")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "ClownCodeRunnerGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 500, 0, 300)
mainFrame.Position = UDim2.new(0.5, -250, 0.3, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 60)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 12)

-- Drag Bar
local dragBar = Instance.new("Frame")
dragBar.Size = UDim2.new(1, 0, 0, 40)
dragBar.BackgroundTransparency = 1
dragBar.Parent = mainFrame

-- Dragging
local dragging, dragInput, dragStart, startPos
dragBar.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragStart = input.Position
		startPos = mainFrame.Position
	end
end)
dragBar.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement then
		dragInput = input
	end
end)
game:GetService("UserInputService").InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		local delta = input.Position - dragStart
		mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end
end)
dragBar.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = false
	end
end)

-- Header
local header = Instance.new("TextLabel")
header.Size = UDim2.new(1, 0, 0, 40)
header.BackgroundTransparency = 1
header.Text = "Clown Gui Executor"
header.Font = Enum.Font.FredokaOne
header.TextScaled = true
header.TextColor3 = Color3.fromRGB(255, 0, 0)
header.Parent = mainFrame

Instance.new("UIStroke", header).Thickness = 4
header.UIStroke.Color = Color3.new(0, 0, 0)

-- Rainbow header animation
task.spawn(function()
	local hue = 0
	while true do
		hue = (hue + 1) % 360
		header.TextColor3 = Color3.fromHSV(hue / 360, 1, 1)
		task.wait(0.05)
	end
end)

-- Code Highlighting Layer (TextLabel)
local highlightLabel = Instance.new("TextLabel")
highlightLabel.Size = UDim2.new(0.9, 0, 0, 140)
highlightLabel.Position = UDim2.new(0.05, 0, 0.2, 0)
highlightLabel.BackgroundTransparency = 1
highlightLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
highlightLabel.Font = Enum.Font.Code
highlightLabel.TextSize = 16
highlightLabel.TextXAlignment = Enum.TextXAlignment.Left
highlightLabel.TextYAlignment = Enum.TextYAlignment.Top
highlightLabel.TextWrapped = true
highlightLabel.RichText = true
highlightLabel.Text = ""
highlightLabel.Parent = mainFrame
highlightLabel.ZIndex = 1

-- Actual Code Box (Transparent on top)
local codeBox = Instance.new("TextBox")
codeBox.Size = highlightLabel.Size
codeBox.Position = highlightLabel.Position
codeBox.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
codeBox.BackgroundTransparency = 0.1
codeBox.TextColor3 = Color3.new(1, 1, 1)
codeBox.ClearTextOnFocus = false
codeBox.PlaceholderText = "-- made by 1x1x1 type code here"
codeBox.MultiLine = true
codeBox.TextWrapped = true
codeBox.Font = Enum.Font.Code
codeBox.TextSize = 16
codeBox.TextXAlignment = Enum.TextXAlignment.Left
codeBox.TextYAlignment = Enum.TextYAlignment.Top
codeBox.Text = ""
codeBox.Parent = mainFrame
codeBox.ZIndex = 2
Instance.new("UICorner", codeBox).CornerRadius = UDim.new(0, 8)

-- Run Button
local runButton = Instance.new("TextButton")
runButton.Size = UDim2.new(0.4, 0, 0, 40)
runButton.Position = UDim2.new(0.3, 0, 0.78, 0)
runButton.BackgroundColor3 = Color3.fromRGB(85, 0, 170)
runButton.TextColor3 = Color3.new(1, 1, 1)
runButton.Text = "Run Script"
runButton.Font = Enum.Font.FredokaOne
runButton.TextScaled = true
runButton.AutoButtonColor = true
runButton.Parent = mainFrame
Instance.new("UICorner", runButton).CornerRadius = UDim.new(0, 10)

-- ‚úÖ Notification System
local function showNotification(message, color)
	local note = Instance.new("TextLabel")
	note.Size = UDim2.new(0.6, 0, 0, 30)
	note.Position = UDim2.new(0.2, 0, -0.1, 0)
	note.BackgroundColor3 = color or Color3.fromRGB(0, 200, 255)
	note.BackgroundTransparency = 0.2
	note.Text = message
	note.TextScaled = true
	note.Font = Enum.Font.FredokaOne
	note.TextColor3 = Color3.new(1, 1, 1)
	note.ZIndex = 3
	note.Parent = mainFrame
	Instance.new("UICorner", note).CornerRadius = UDim.new(0, 8)

	game:GetService("TweenService"):Create(note, TweenInfo.new(0.5), {
		Position = UDim2.new(0.2, 0, 0.02, 0)
	}):Play()

	task.wait(2.5)

	game:GetService("TweenService"):Create(note, TweenInfo.new(0.5), {
		TextTransparency = 1,
		BackgroundTransparency = 1
	}):Play()

	task.wait(0.6)
	note:Destroy()
end

-- ‚úÖ Syntax Highlighting Logic
local keywords = {
	["function"] = true, ["end"] = true, ["local"] = true,
	["if"] = true, ["then"] = true, ["else"] = true,
	["elseif"] = true, ["for"] = true, ["while"] = true,
	["do"] = true, ["return"] = true, ["true"] = true,
	["false"] = true, ["nil"] = true, ["not"] = true,
	["and"] = true, ["or"] = true, ["pcall"] = true,
	["loadstring"] = true, ["game"] = true, ["wait"] = true,
	["warn"] = true
}

local function highlight(text)
	text = text:gsub("([%w_]+)", function(word)
		if keywords[word] then
			return string.format("<font color=\"rgb(0,255,0)\">%s</font>", word)
		end
		return word
	end)
	return "<font color=\"rgb(200,200,200)\">" .. text .. "</font>"
end

-- Sync highlight with textbox
codeBox:GetPropertyChangedSignal("Text"):Connect(function()
	highlightLabel.Text = highlight(codeBox.Text)
end)

-- ‚úÖ Run Script with Notifications
runButton.MouseButton1Click:Connect(function()
	local code = codeBox.Text
	local func, err = loadstring(code)
	if func then
		local success, runtimeErr = pcall(func)
		if success then
			showNotification("‚úÖ script ran clown!!", Color3.fromRGB(0, 200, 0))
		else
			showNotification("‚ö†Ô∏è Runtime Error!", Color3.fromRGB(255, 120, 0))
			warn("Runtime Error: " .. runtimeErr)
		end
	else
		showNotification("‚ùå Syntax Error!", Color3.fromRGB(255, 0, 0))
		warn("Syntax Error: " .. err)
	end
end)

-- Run Button
runButton.Size = UDim2.new(0.28, 0, 0, 40)
runButton.Position = UDim2.new(0.05, 0, 0.78, 0)

-- Copy to Clipboard Button
local copyButton = Instance.new("TextButton")
copyButton.Size = UDim2.new(0.28, 0, 0, 40)
copyButton.Position = UDim2.new(0.36, 0, 0.78, 0)
copyButton.BackgroundColor3 = Color3.fromRGB(0, 85, 170)
copyButton.TextColor3 = Color3.new(1, 1, 1)
copyButton.Text = "Copy"
copyButton.Font = Enum.Font.FredokaOne
copyButton.TextScaled = true
copyButton.AutoButtonColor = true
copyButton.ZIndex = 2
copyButton.Parent = mainFrame
Instance.new("UICorner", copyButton).CornerRadius = UDim.new(0, 10)

-- Clear Button
local clearButton = Instance.new("TextButton")
clearButton.Size = UDim2.new(0.28, 0, 0, 40)
clearButton.Position = UDim2.new(0.67, 0, 0.78, 0)
clearButton.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
clearButton.TextColor3 = Color3.new(1, 1, 1)
clearButton.Text = "Clear"
clearButton.Font = Enum.Font.FredokaOne
clearButton.TextScaled = true
clearButton.AutoButtonColor = true
clearButton.ZIndex = 2
clearButton.Parent = mainFrame
Instance.new("UICorner", clearButton).CornerRadius = UDim.new(0, 10)

-- Copy to Clipboard Logic
copyButton.MouseButton1Click:Connect(function()
	local success = pcall(function()
		setclipboard(codeBox.Text)
	end)
	if success then
		showNotification("üìã Code copied!", Color3.fromRGB(0, 150, 255))
	else
		showNotification("‚ùå Clipboard failed!", Color3.fromRGB(255, 0, 0))
	end
end)

-- Clear Textbox Logic
clearButton.MouseButton1Click:Connect(function()
	codeBox.Text = ""
	showNotification("üßπ Code cleared!", Color3.fromRGB(255, 255, 0))
end)
